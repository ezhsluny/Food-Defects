# Food-Defects

–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–æ–¥—É–ª—å –ò–ò-–æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –¥–µ—Ñ–µ–∫—Ç–æ–≤ –Ω–∞ –ø–∏—â–µ–≤—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–∞—Ö, —Ä–∞–±–æ—Ç–∞—é—â–∏–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–º –æ—Å–≤–µ—â–µ–Ω–∏–∏.

## üéØ –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞

–ü–æ–≤—ã—Å–∏—Ç—å —Ç–æ—á–Ω–æ—Å—Ç—å –≤—ã—è–≤–ª–µ–Ω–∏—è –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π –Ω–∞ 35% –∏ —Å–Ω–∏–∑–∏—Ç—å –ø–æ—Ç–µ—Ä–∏ –ø—Ä–æ–¥—É–∫—Ü–∏–∏ –Ω–∞ –ø–∏—â–µ–≤—ã—Ö –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è—Ö.

## üìã –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üîç **–î–µ—Ç–µ–∫—Ü–∏—è –¥–µ—Ñ–µ–∫—Ç–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ 30 –∫–∞–¥—Ä–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É
- üåà **–ê–¥–∞–ø—Ç–∞—Ü–∏—è –∫ –æ—Å–≤–µ—â–µ–Ω–∏—é** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —è—Ä–∫–æ—Å—Ç–∏ –∏ –∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω–æ—Å—Ç–∏
- üçé **–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–µ—Ñ–µ–∫—Ç–æ–≤** - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –∏ —Å—Ç–µ–ø–µ–Ω–∏ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏—è
- üìä **–ê–Ω–∞–ª–∏–∑ –∏ –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å** - –æ—Ü–µ–Ω–∫–∞ –ø–ª–æ—â–∞–¥–∏ –¥–µ—Ñ–µ–∫—Ç–∞, –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è, —É—Ä–æ–≤–µ–Ω—å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏
- üîÑ **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ–º** - API –¥–ª—è —Å–∏—Å—Ç–µ–º MES, ERP, —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–æ–º
- üß† **–û–±—É—á–µ–Ω–∏–µ –Ω–∞ –æ—à–∏–±–∫–∞—Ö** - online learning —Å –¥–æ–æ–±—É—á–µ–Ω–∏–µ–º –Ω–∞ –ø–æ–º–µ—á–µ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º –¥–∞–Ω–Ω—ã—Ö

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install ultralytics opencv-python pillow numpy matplotlib streamlit flask
```

### –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã

```bash
python main.py
```

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

### –û—Å–Ω–æ–≤–Ω—ã–µ –º–æ–¥—É–ª–∏
1. –ì–ª–∞–≤–Ω—ã–π –º–æ–¥—É–ª—å (main.py)
python
```bash
from detect_deffects import AppleDefectDetector  
from video_capture import advanced_preprocessing
from make_bbox_apples import DetectorApples
```

2. –î–µ—Ç–µ–∫—Ü–∏—è —è–±–ª–æ–∫ (make_bbox_apples.py)
python
```bash
class DetectorApples:
    def __init__(self):
        self.model = YOLO("yolo11n.pt")
    
    def crop_bboxes(self, image):
        # –í—ã—Ä–µ–∑–∞–µ—Ç —Ä–µ–≥–∏–æ–Ω—ã —Å –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–º–∏ —è–±–ª–æ–∫–∞–º–∏
```
3. –î–µ—Ç–µ–∫—Ü–∏—è –¥–µ—Ñ–µ–∫—Ç–æ–≤ (detect_deffects.py)
python
```bash
class AppleDefectDetector:
    def __init__(self, model_path, conf_threshold=0.25):
        self.model = YOLO(model_path)
        self.class_names = ['crit_def', 'mid_def', 'small_def', 'no_def']
```
4. –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∏–¥–µ–æ (video_capture.py)
python
```bash
def advanced_preprocessing(img):
    # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ—Ä—Ä–µ–∫—Ü–∏—è —è—Ä–∫–æ—Å—Ç–∏ –∏ –∫–æ–Ω—Ç—Ä–∞—Å—Ç–∞
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```bash
food-defect-detection/
‚îú‚îÄ‚îÄ main.py                      # –ì–ª–∞–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞ —Å–∏—Å—Ç–µ–º—ã
‚îú‚îÄ‚îÄ make_bbox_apples.py          # –î–µ—Ç–µ–∫—Ç–æ—Ä —è–±–ª–æ–∫ –Ω–∞ –æ—Å–Ω–æ–≤–µ YOLO
‚îú‚îÄ‚îÄ detect_deffects.py           # –î–µ—Ç–µ–∫—Ç–æ—Ä –¥–µ—Ñ–µ–∫—Ç–æ–≤ —è–±–ª–æ–∫
‚îú‚îÄ‚îÄ video_capture.py             # –ú–æ–¥—É–ª—å –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤–∏–¥–µ–æ –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
‚îú‚îÄ‚îÄ apples_defects_yolov8.pt     # –ú–æ–¥–µ–ª—å –¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏ –¥–µ—Ñ–µ–∫—Ç–æ–≤
‚îú‚îÄ‚îÄ detection_results/           # –ü–∞–ø–∫–∞ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏
‚îî‚îÄ‚îÄ README.md                    # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

# üéÆ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç 4 –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–µ—Ñ–µ–∫—Ç–æ–≤:

üî¥ crit_def - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –¥–µ—Ñ–µ–∫—Ç—ã (–Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ)

üü† mid_def - –ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ—Ñ–µ–∫—Ç—ã (–æ—Ç–±—Ä–∞–∫–æ–≤–∫–∞)

üü° small_def - –ù–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ—Ñ–µ–∫—Ç—ã (–ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞)

üü¢ no_def - –ë–µ–∑ –¥–µ—Ñ–µ–∫—Ç–æ–≤


## üìä –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
–§–æ—Ä–º–∞—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
```bash
json
{
  "original_image_shape": [480, 640, 3],
  "detections": [
    {
      "bbox": {
        "xyxy": [100, 150, 200, 250],
        "xywh": [150, 200, 100, 100],
        "area": 10000
      },
      "class_id": 0,
      "class_name": "crit_def",
      "confidence": 0.91
    }
  ],
  "summary": {
    "total_detections": 1,
    "defects_count": 1,
    "defects_by_class": {
      "crit_def": 1,
      "mid_def": 0,
      "small_def": 0,
      "no_def": 0
    }
  }
}
```
## –¢–µ–∫—Å—Ç–æ–≤–∞—è —Å–≤–æ–¥–∫–∞
```bash
–°–í–û–î–ö–ê –î–ï–¢–ï–ö–¶–ò–ò –î–ï–§–ï–ö–¢–û–í:
-------------------------
–í—Å–µ–≥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ –æ–±—ä–µ–∫—Ç–æ–≤: 3
–í—Å–µ–≥–æ –¥–µ—Ñ–µ–∫—Ç–æ–≤: 2

–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –∫–ª–∞—Å—Å–∞–º:
  - crit_def: 1
  - mid_def: 1
  - small_def: 0
  - no_def: 1

‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï: –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –¥–µ—Ñ–µ–∫—Ç—ã!
```

# üõ†Ô∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
Python 3.8+

OpenCV - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ –≤–∏–¥–µ–æ

Ultralytics YOLOv8/v11 - –¥–µ—Ç–µ–∫—Ü–∏—è –æ–±—ä–µ–∫—Ç–æ–≤

Pillow - —Ä–∞–±–æ—Ç–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏

NumPy - —á–∏—Å–ª–µ–Ω–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è

–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
‚è±Ô∏è –°–∫–æ—Ä–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏: –¥–æ 30 FPS

üñºÔ∏è –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ: –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–µ, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 640x480

üí° –û—Å–≤–µ—â–µ–Ω–∏–µ: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è

üéØ –¢–æ—á–Ω–æ—Å—Ç—å: >90% –¥–ª—è –æ–±—É—á–µ–Ω–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤ –¥–µ—Ñ–µ–∫—Ç–æ–≤

# üë• –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏
- [Yulia Basova](https://github.com/ezhsluny)
- [Vishnakova Alisa](https://github.com/VishA1308)
- [Natalia Bedareva](https://github.com/NatashaBedareva)